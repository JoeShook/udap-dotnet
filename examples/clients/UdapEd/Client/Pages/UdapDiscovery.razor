@page "/udapDiscovery"
@using Udap.Client.Internal

<ErrorBoundary @ref="ErrorBoundary">
  <ChildContent>
    <MudGrid Class="mt-4">
      <MudItem xs="12" sm="12" md="12">
        <MudText Typo="Typo.h4">Udap Metadata</MudText>
      </MudItem>
      <MudItem xs="12" sm="12" md="12">
        <MudGrid Spacing="2" Justify="Justify.FlexStart">
          <MudItem>
            <MudButton Class="mt-3"
                       ButtonType="ButtonType.Button"
                       Variant="Variant.Filled"
                       OnClick="GetMetadata">Query</MudButton>
          </MudItem>
          <MudItem>
            <MudButton Class="mt-3"
                       ButtonType="ButtonType.Button"
                       Variant="Variant.Filled"
                       OnClick="RemoveBaseUrl">Remove Base Url</MudButton>
          </MudItem>
        </MudGrid>
        <MudAutocomplete T="string"
                         Label="Enter BaseUrl"
                         AutoFocus="true"
                         HelperText=@($"UDAP Metadata URL: {GetWellKnownUdap(BaseUrl)}")
                         @bind-Value="BaseUrl"
                         @bind-Text="BaseUrl"
                         SearchFunc="@GetMetadata"
                         CoerceText="false"
                         CoerceValue="false"
                         ResetValueOnEmptyText="true"
                         />

        <pre>@Result</pre>
        <MudSpacer />
      </MudItem>
    </MudGrid>


  </ChildContent>
  <ErrorContent Context="ex">
    <pre class="blazor-error-boundary">
            @ex.Message
      </pre>
  </ErrorContent>
</ErrorBoundary>