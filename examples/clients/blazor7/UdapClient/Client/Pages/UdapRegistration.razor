@page "/udapRegistration"

<InputFile id="fileInput" OnChange="UploadFilesAsync" hidden />

<ErrorBoundary @ref="ErrorBoundary">
  <ChildContent>

    <MudGrid Class="mt-4">
      <MudItem xs="12" sm="12" md="12">
        <MudText Typo="Typo.h3">Udap Metadata</MudText>
      </MudItem>
      <MudItem xs="12" sm="12" md="12">
        <MudFab HtmlTag="label"
                Size="Size.Small"
                Color="Color.Success"
                Icon="@Icons.Filled.AttachFile"
                Label="Upload Client Certificate"
                for="fileInput" />
        <MudTextField @bind-Value="Password"
                      Label="Password"
                      Variant="Variant.Text"
                      InputType="@PasswordInput"
                      Adornment="Adornment.End"
                      AdornmentIcon="@PasswordInputIcon"
                      OnAdornmentClick="ButtonTestclick"
                      AdornmentAriaLabel="Show Password" />
        <MudSpacer />
        <MudSelect @bind-Value="Oauth2Flow" Label="Select fast-food"
                   HelperText="String"
                   Placeholder="Please Select"
                   AdornmentIcon="@Icons.Material.Filled.Build"
                   AdornmentColor="Color.Primary">
            @foreach (Oauth2FlowEnum item in Enum.GetValues(typeof(Oauth2FlowEnum)))
            {
                <MudSelectItem Value="@item">@item</MudSelectItem>
            }

        </MudSelect>
        <MudButton Class="mt-3" ButtonType="ButtonType.Button"
                   Variant="Variant.Filled"
                   OnClick="Build">Build authorization code request. (header and raw software statement)</MudButton>
        <MudSpacer />
        
        <MudItem>
          <MudText Typo="Typo.h5">@Oauth2Flow.ToString()</MudText>
          <pre contenteditable>@SoftwareStatementBeforeEncoding</pre>
          <MudButton Class="mt-3" ButtonType="ButtonType.Button"
                     Variant="Variant.Filled"
                     OnClick="BuildRequestBody">Build Request Body</MudButton>
          <MudText Typo="Typo.h5">Request Body</MudText>
          <pre>@RequestBody</pre>
        </MudItem>
        <MudButton Class="mt-3" ButtonType="ButtonType.Button"
                   Variant="Variant.Filled"
                   OnClick="PerformRegistration">Register (DCR)</MudButton>
        <MudText Typo="Typo.h5">Access Code</MudText>
        <pre>@RegistrationResult</pre>
        <MudSpacer />
      </MudItem>
    </MudGrid>


  </ChildContent>
  <ErrorContent Context="ex">
    <pre class="blazor-error-boundary">
            @ex.Message
      </pre>
  </ErrorContent>
</ErrorBoundary>